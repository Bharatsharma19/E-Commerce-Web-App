<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js
    "></script>
    <title>Home</title>
  </head>
  <body>
    <h4
      style="
        display: flex;
        justify-content: center;
        align-items: center;
        text-decoration: underline;
      "
    >
      <b> Available Products </b>
    </h4>

    <% if(status==false) {%>
    <h3 style="display: flex; justify-content: center; align-items: center">
      <%= data %>
    </h3>
    <%} else { %>
    <table class="table centered">
      <thead>
        <tr>
          <th>Product Id</th>
          <th>Product Name</th>
          <th>Description</th>
          <th>Category - SubCategory - Brand - Rating</th>
          <th>Price - Offer Price</th>
          <th>Status - Stock</th>
          <th>Picture</th>
          <th>Action</th>
        </tr>
      </thead>
      <% data.map((item)=>{%>
      <tbody>
        <tr>
          <td><%= item.productid %></td>
          <td><%= item.productname %></td>
          <td><%= item.description %></td>
          <td>
            <%= item.categoryname %> - <%= item.subcategoryname %> -
            <%=item.brandname %> - <%= item.rating %>
          </td>
          <td>
            <s style="color: red"> &#8377; <%=item.price%>/-</s>
            <b style="color: blue"> &#8377;<%= item.offerprice %>/- </b>
          </td>
          <td><%= item.status %> - <strong><%= item.stock %></strong></td>
          <td>
            <img
              src="/images/<%= item.picture %>"
              alt="Picture"
              style="border-radius: 128px; width: 64px"
            />
          </td>
          <td>
            <input
              class="ves-effect waves-light btn-small btnEdit"
              type="button"
              value="Edit"
              id="btnEdit"
              products="<%=JSON.stringify(item)%>"
            />
            <input
              class="ves-effect waves-light btn-small btnDelete"
              type="button"
              value="Delete"
            />
          </td>
        </tr>
      </tbody>
      <%})%>
    </table>
    <% } %>

    <!-- Modal -->

    <!-- Modal Structure -->
    <div id="product" class="modal">
      <div class="modal-content">
        <h4 style="display: flex; justify-content: center; align-items: center">
          Modify Product Details
        </h4>
        <p id="products"></p>
      </div>
      <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat"
          >Submit</a
        >
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script defer>
      $(document).ready(function () {
        $(".modal").modal();

        $(".btnEdit").click(function () {
          $("#product").modal("open");
          const item = JSON.parse($(this).attr("products"));
          alert(item.productname);
        });
      });
    </script>
  </body>
</html>
